---
published: true
title: 💙 데이터베이스 - 인덱스란 무엇이고 일반적인 원리는 어떠한지 설명하시오.
author: LeeNaYoung
date:   2024-12-11 16:03:02 +09:00
categories: [CS]
tags: [CS]
---

## 인덱스

데이터베이스에서 데이터의 주소를 저장해 검색 능력을 향상 시켜주는 자료구조

즉, 데이터 검색을 빠르게 하기 위한 자료구조

- 마치 책의 목차처럼 데이터를 찾는 데 도움이 되는 도구로, 특정 컬럼이나 여러 컬럼에 대해 검색을 최적화할 수 있다. 

- 데이터베이스에서 테이블의 모든 데이터를 검색할 때 많은 시간이 소요된다. 따라서 데이터와 데이터의 위치를 포함한 자료구조를 생성해 빠르게 조회할 수 있도록 한다.

- 만약 인덱스를 사용하지 않고 조회할 시에는 테이블 전체를 탐색하는 `Full Scan`이 수행됨으로써 처리 속도가 떨어지게 된다.

## 일반적인 원리

### 자료 구조

인덱스는 주로 트리 구조(보통 B-트리)로 구현된다. 트리 구조는 데이터를 효율적으로 검색할 수 있도록 해준다. 예를 들어, B-트리에서는 데이터를 찾을 때 트리의 깊이를 따라가며 탐색하는 방식으로 시간 복잡도 **O(log N)**으로 줄여준다.


### 데이터 검색 최적화

DB에서 인덱스가 없는 경우, 전체 테이블을 검색해야 하므로 검색 속도가 느려진다. 하지만 인덱스가 있으면 데이터가 정렬되어 저장되기 때문에  **이진 탐색(binary search)** 방식으로 데이터를 빠르게 찾을 수 있다.


### 빠른 접근

인덱스는 해당 컬럼의 값을 정렬하거나 해시값을 사용해 빠른 검색을 가능하게 한다. 예를 들어 `WHERE` 절에 사용되는 컬럼이나 `JOIN` 절에서 자주 사용되는 컬럼에 인덱스를 적용하면 검색 성능을 크게 향상시킬 수 있다.

### 장점

1. 검색 속도가 빨라진다.

2. 큰 데이터베이스에서 데이터 조회 시 성능이 향상된다.

3. `JOIN`과 `ORDER BY` 쿼리에서 성능이 개선된다.


### 단점

1. 인덱스 생성과 유지 관리에 추가적인 공간과 시간이 소요된다.

2. 데이터 삽입, 삭제, 수정 시 인덱스도 업데이트해야 하므로 성능 저하가 있을 수 있다.

###  인덱스를 사용하면 좋은 경우

1. 규모가 작지 않은 테이블

2. `INSERT`, `UPDATE`, `DELETE`가 자주 발생하지 않는 컬럼

3. `JOIN`, `WHERE`, `ORDER BY`에 자주 사용되는 컬럼

4. 데이터의 중복도가 낮은 컬럼


## 모든 요소에 인덱스를 걸지 않는 이유는 무엇일까?

인덱스를 생성하면 INSERT, DELETE, UPDATE 쿼리문을 실행할 때 별도의 과정이 추가적으로 발생한다.
INSERT의 경우 인덱스에 대한 데이터도 추가해야 하므로 그만큼 성능 손실이 생긴다.
DELETE의 경우 인덱스에 존재하는 값은 삭제하지 않고 사용 안한다는 표시로 남게된다.

따라서 ROW의 수는 그대로인데 이러한 작업이 반복되면 실데이터가 10만건인데 데이터가 100만건이 있는 결과가 생길 수 있다.

UPDATE의 경우 INSERT, DELETE의 문제점을 동시에 수반한다.
이전 데이터가 삭제되고 그 자리에 새 데이터가 들어오는 개념이기 때문이다. 컬럼을 이루고 있는 데이터의 형식에 따라서 인덱스의 성능이 악영향을 미칠 수 있다. 



즉, 인덱스를 사용하면 테이블을 검색하는 속도와 성능이 향상되는 장점이 존재하지만 인덱스를 관리하기 위한 추가 작업이 필요하며 추가 저장 공간 또한 필요하다. 데이터의 형식에 따라 성능이 저하될 수 있고 인덱스가 적용된 컬럼에 삽입, 삭제, 수정이 잦다면 인덱스 또한 수정해야 하기 때문에 성능이 낮아진다. 또한 인덱스는 제거되는 것이 아닌 '사용하지 않음'으로 남겨두기 때문에 인덱스가 과도하게 커질 수 있기에 모든 요소에 인덱스를 걸지 않는다. 


## 복합인덱스란?

DB에서 여러 개의 컬럼들을 조합하여 인덱스를 생성하는 것을 말한다.

단일 인덱스(Single Index)가 한 개의 컬럼에 대해 생성되는 것과는 달리, 복합 인덱스는 여러 개의 컬럼을 함께 사용하여 인덱스를 생성한다.

### 복합 인덱스 장점

예시로 학생 정보의 DB에서 학생 이름과 학번을 검색하는 경우 단일 인덱스로 이름과 학번을 모두 인덱싱한다면 DB는 인덱스에 해당되는 모든 레코드를 검색하고 필터링하는 데 많은 시간이 소요된다.

하지만 복합 인덱스를 사용하면 이름과 학번 열을 통합하여 하나의 인덱스로 만들 수 있다. 이로인해 더 빠르게 레코드를 검색할 수 있게 된다.

- 여러 개의 컬럼을 동시에 검색할 수 있어서 검색 속도가 개선된다.

- 인덱스를 생성할 때 여러 개의 컬럼을 함께 사용하면 인덱스의 용량이 줄어든다.

- 쿼리가 여러 개의 조건을 가지고 있을 때 최적화된 실행 계획을 수립할 수 있다.

### 복합 인덱스 컬럼 선택

1.  where절에서 and 조건으로 자주 결합되어 사용되면서 각각의 분포도 보다 두 개 이상의 컬럼이 결합될 때 분포도가 좋아지는 컬럼들

2. 다른 테이블과 조인의 연결고리로 자주 사용되는 컬럼들

3. order by에서 자주 사용되는 컬럼들

4. 하나 이상의 키 컬럼 조건으로 같은 테이블의 컬럼들이 자주 조회될 때

## 정리

>인덱스는 DB에서 데이터를 빠르게 검색하기 위한 자료 구조로, 주로 트리 구조(B-트리)로 구현된다. 인덱스를 사용하면 전체 테이블을 검색하지 않고 정렬된 데이터를 효율적으로 탐색하여 성능을 향상시킬 수 있다. 주로 `WHERE` 절이나 `JOIN` 절에서 자주 사용되는 컬럼에 적용되며, 복합 인덱스를 통해 여러 조건을 동시에 최적화할 수 있다. 그러나 인덱스는 추가적인 저장 공간을 요구하고 데이터 삽입, 삭제, 수정 시 인덱스를 갱신해야 하므로 성능에 영향을 미칠 수 있다.
{: .prompt-tip }